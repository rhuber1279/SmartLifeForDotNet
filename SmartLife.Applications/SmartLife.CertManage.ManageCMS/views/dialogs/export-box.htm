<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script type="text/javascript" src="../../script/jquery/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="../../script/jquery/jquery.json-2.2.min.js"></script>
    <script type="text/javascript">
        $(function () {
            var formData = parent.window.exportFileData();
            if (formData) {
                $('#ExportData').val($.toJSON(formData.actionData));
                $('#ExportType').val(formData.actionType);
                $("#fm-export-data").attr("action", formData.actionUrl);

                document.getElementById("fm-export-data").submit();
            }
        })
        
        /*
        function loadExport(actionUrl, actionType, formdata) {
            //parent.window.baseCMSInvokeUrl + '/AppShare/ExportExcel.ashx'
            if (formdata) {
                $('#ExportData').val($.toJSON(formdata));
                $('#ExportType').val(actionType);
                $("#fm-export-data").attr("action", actionUrl);

                document.getElementById("fm-export-data").submit();
            }
        }
        */

        /*//模拟表单提交
        function postFormTo(iframeParams) {
            var arrs = "ExportData=" + $.toJSON(iframeParams);
            postFormTo(arrs);
            var xmlhttp;
            if (window.XMLHttpRequest) {
                // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else {
                // code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }

            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    alert(xmlhttp.getResponseHeader("Content-Type"));
                }
            }

            xmlhttp.open("POST", parent.window.baseCMSInvokeUrl + '/AppShare/ExportExcel.ashx', false);
            xmlhttp.setRequestHeader("Content-Length", iframeParams.length);
            xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;");  //用POST的时候一定要有这句  
            xmlhttp.send(iframeParams);
        }*/
    </script>
</head>
<body>
    <form id="fm-export-data" method="post" action="" >
        <input type="hidden" id="ExportType" name="ExportType"/>
        <input type="hidden" id="ExportData" name="ExportData"/>
    </form>
</body>
</html>
